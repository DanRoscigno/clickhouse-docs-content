"use strict";(self.webpackChunkclickhouse=self.webpackChunkclickhouse||[]).push([[57344],{3905:function(t,e,n){n.d(e,{Zo:function(){return p},kt:function(){return h}});var a=n(67294);function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e){if(null==t)return{};var n,a,i=function(t,e){if(null==t)return{};var n,a,i={},r=Object.keys(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var c=a.createContext({}),s=function(t){var e=a.useContext(c),n=e;return t&&(n="function"==typeof t?t(e):o(o({},e),t)),n},p=function(t){var e=s(t.components);return a.createElement(c.Provider,{value:e},t.children)},u={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},d=a.forwardRef((function(t,e){var n=t.components,i=t.mdxType,r=t.originalType,c=t.parentName,p=l(t,["components","mdxType","originalType","parentName"]),d=s(n),h=i,k=d["".concat(c,".").concat(h)]||d[h]||u[h]||r;return n?a.createElement(k,o(o({ref:e},p),{},{components:n})):a.createElement(k,o({ref:e},p))}));function h(t,e){var n=arguments,i=e&&e.mdxType;if("string"==typeof t||i){var r=n.length,o=new Array(r);o[0]=d;var l={};for(var c in e)hasOwnProperty.call(e,c)&&(l[c]=e[c]);l.originalType=t,l.mdxType="string"==typeof t?t:i,o[1]=l;for(var s=2;s<r;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},67740:function(t,e,n){n.d(e,{ZP:function(){return c}});var a=n(87462),i=n(63366),r=(n(67294),n(3905)),o=["components"],l={toc:[]};function c(t){var e=t.components,c=(0,i.Z)(t,o);return(0,r.kt)("wrapper",(0,a.Z)({},l,c,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"To connect to ClickHouse with HTTP(S) you need this information:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The HOST and PORT: typically, the port is 8443 when using TLS or 8123 when not using TLS.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The DATABASE NAME: out of the box, there is a database named ",(0,r.kt)("inlineCode",{parentName:"p"},"default"),", use the name of the database that you want to connect to.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The USERNAME and PASSWORD: out of the box, the username is ",(0,r.kt)("inlineCode",{parentName:"p"},"default"),". Use the username appropriate for your use case."))),(0,r.kt)("p",null,"The details for your ClickHouse Cloud service are available in the ClickHouse Cloud console.  Select the service that you will connect to and click ",(0,r.kt)("strong",{parentName:"p"},"Connect"),":"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"ClickHouse Cloud service connect button",src:n(64872).Z,width:"939",height:"474"})),(0,r.kt)("p",null,"Choose ",(0,r.kt)("strong",{parentName:"p"},"HTTPS"),", and the details are available in an example ",(0,r.kt)("inlineCode",{parentName:"p"},"curl")," command. "),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"ClickHouse Cloud HTTPS connection details",src:n(33273).Z,width:"586",height:"470"})),(0,r.kt)("p",null,"If you are using self-managed ClickHouse, the connection details are set by your ClickHouse administrator."))}c.isMDXComponent=!0},29117:function(t,e,n){n.r(e),n.d(e,{assets:function(){return u},contentTitle:function(){return s},default:function(){return k},frontMatter:function(){return c},metadata:function(){return p},toc:function(){return d}});var a=n(87462),i=n(63366),r=(n(67294),n(3905)),o=n(67740),l=["components"],c={sidebar_label:"Introduction",sidebar_position:10,keywords:["clickhouse","python","client","connect","integrate"],slug:"/en/integrations/language-clients/python/intro",description:"The ClickHouse Connect project suite for connecting Python to ClickHouse"},s="Python Integration with ClickHouse Connect",p={unversionedId:"en/integrations/language-clients/python/intro",id:"en/integrations/language-clients/python/intro",title:"Python Integration with ClickHouse Connect",description:"The ClickHouse Connect project suite for connecting Python to ClickHouse",source:"@site/docs/en/integrations/language-clients/python/intro.md",sourceDirName:"en/integrations/language-clients/python",slug:"/en/integrations/language-clients/python/intro",permalink:"/docs/en/integrations/language-clients/python/intro",draft:!1,editUrl:"https://github.com/ClickHouse/clickhouse-docs/blob/main/docs/en/integrations/language-clients/python/intro.md",tags:[],version:"current",sidebarPosition:10,frontMatter:{sidebar_label:"Introduction",sidebar_position:10,keywords:["clickhouse","python","client","connect","integrate"],slug:"/en/integrations/language-clients/python/intro",description:"The ClickHouse Connect project suite for connecting Python to ClickHouse"},sidebar:"english",previous:{title:"Python",permalink:"/docs/en/integrations/python"},next:{title:"Driver API",permalink:"/docs/en/integrations/language-clients/python/driver-api"}},u={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Requirements and Compatibility",id:"requirements-and-compatibility",level:2},{value:"Installation",id:"installation",level:2},{value:"Support Policy",id:"support-policy",level:2},{value:"Basic Usage",id:"basic-usage",level:2},{value:"Gather your connection details",id:"gather-your-connection-details",level:3},{value:"Establish a connection",id:"establish-a-connection",level:3},{value:"Use a ClickHouse Connect client instance to connect to a ClickHouse server on localhost:",id:"use-a-clickhouse-connect-client-instance-to-connect-to-a-clickhouse-server-on-localhost",level:4},{value:"Use a ClickHouse Connect client instance to connect to a ClickHouse Cloud service:",id:"use-a-clickhouse-connect-client-instance-to-connect-to-a-clickhouse-cloud-service",level:4},{value:"Interact with your database",id:"interact-with-your-database",level:3}],h={toc:d};function k(t){var e=t.components,n=(0,i.Z)(t,l);return(0,r.kt)("wrapper",(0,a.Z)({},h,n,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"python-integration-with-clickhouse-connect"},"Python Integration with ClickHouse Connect"),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"ClickHouse Connect is a suite of Python packages providing interoperability with a wide range of Python applications.\nThe three primary components are:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"A low level driver in the package ",(0,r.kt)("inlineCode",{parentName:"li"},"clickhouse_connect.driver"),". This package includes a basic client that handles\nall ClickHouse Connect requests to the ClickHouse Server, as well assorted helper classes and utility functions."),(0,r.kt)("li",{parentName:"ul"},"A limited ",(0,r.kt)("a",{parentName:"li",href:"https://www.sqlalchemy.org/"},"SQLAlchemy")," dialect in the package ",(0,r.kt)("inlineCode",{parentName:"li"},"clickhouse_connect.cc_sqlalchemy"),". This\npackage focuses implements query/cursor functionality, and does not generally support SQLAlchemy DDL and ORM\noperations.\n(SQLAlchemy is targeted toward OLTP databases, and we recommend more specialized tools and frameworks to manage\nthe ClickHouse OLAP database.)"),(0,r.kt)("li",{parentName:"ul"},"An Apache ",(0,r.kt)("a",{parentName:"li",href:"https://superset.apache.org/"},"Superset")," EngineSpec in the ",(0,r.kt)("inlineCode",{parentName:"li"},"clickhouse_connect.cc_superset"),". This package will\nautomatically add a ",(0,r.kt)("strong",{parentName:"li"},"ClickHouse Connect")," Superset connector when ClickHouses Connect is installed. This EngineSpec\nsupports all core Superset query functionality, but does not currently support certain advanced features such as file\nupload to a ClickHouse table.")),(0,r.kt)("h2",{id:"requirements-and-compatibility"},"Requirements and Compatibility"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"right"},"Python"),(0,r.kt)("th",{parentName:"tr",align:"left"}),(0,r.kt)("th",{parentName:"tr",align:"right"},"Platform\xb9"),(0,r.kt)("th",{parentName:"tr",align:"left"}),(0,r.kt)("th",{parentName:"tr",align:"right"},"ClickHouse"),(0,r.kt)("th",{parentName:"tr",align:"left"}),(0,r.kt)("th",{parentName:"tr",align:"right"},"SQLAlchemy\xb2"),(0,r.kt)("th",{parentName:"tr",align:"left"}),(0,r.kt)("th",{parentName:"tr",align:"right"},"Apache Superset"),(0,r.kt)("th",{parentName:"tr",align:"left"}))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"2.x, <3.7"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Linux (x86)"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"},"<22.3\xb3"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\ud83d\udfe1"),(0,r.kt)("td",{parentName:"tr",align:"right"},"<1.3"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"right"},"<1.4"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u274c")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"3.7.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Linux (Aarch64)"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"},"22.3.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"},"1.3.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"},"1.4.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"3.8.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"},"MacOS (x86)"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"},"22.4-22.6\xb3"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\ud83d\udfe1"),(0,r.kt)("td",{parentName:"tr",align:"right"},"1.4.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"},"1.5.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"3.9.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"},"MacOs (M1)"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"},"22.7.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"},">=2.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u274c"),(0,r.kt)("td",{parentName:"tr",align:"right"},"2.0.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"},"3.10.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"},"Windows"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"},"22.8.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"}),(0,r.kt)("td",{parentName:"tr",align:"left"}),(0,r.kt)("td",{parentName:"tr",align:"right"}),(0,r.kt)("td",{parentName:"tr",align:"left"})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"right"}),(0,r.kt)("td",{parentName:"tr",align:"left"}),(0,r.kt)("td",{parentName:"tr",align:"right"}),(0,r.kt)("td",{parentName:"tr",align:"left"}),(0,r.kt)("td",{parentName:"tr",align:"right"},"22.9.x"),(0,r.kt)("td",{parentName:"tr",align:"left"},"\u2705"),(0,r.kt)("td",{parentName:"tr",align:"right"}),(0,r.kt)("td",{parentName:"tr",align:"left"}),(0,r.kt)("td",{parentName:"tr",align:"right"}),(0,r.kt)("td",{parentName:"tr",align:"left"})))),(0,r.kt)("p",null,"\xb9ClickHouse Connect has been tested against the listed platforms.  Because it can run in pure Python (without the\noptional C optimizations), it is likely to work on most recent Python installations."),(0,r.kt)("p",null,"\xb2Again SQLAlchemy support is limited primarily to query functionality.  The full SQLAlchemy API is not supported."),(0,r.kt)("p",null,"\xb3ClickHouse Connect has been tested against all currently supported ClickHouse versions. Because it uses the HTTP\nprotocol, it should also work correctly for most other versions of ClickHouse, although there may be some\nincompatibilities with certain advanced data types."),(0,r.kt)("h2",{id:"installation"},"Installation"),(0,r.kt)("p",null,"Install ClickHouse Connect from PyPI via pip:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"pip install clickhouse-connect")),(0,r.kt)("p",null,"ClickHouse Connect can also be installed from source by checking out the\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ClickHouse/clickhouse-connect"},"GitHub repository")," and running ",(0,r.kt)("inlineCode",{parentName:"p"},"pip install ."),"\nin the project root directory."),(0,r.kt)("h2",{id:"support-policy"},"Support Policy"),(0,r.kt)("p",null,"ClickHouse Connect is currently in beta and only the current beta release is actively supported. Please update to the latest\nversion before reported any issues. Issues should be filed in\nthe ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/ClickHouse/clickhouse-connect/issues"},"GitHub project"),".",(0,r.kt)("br",{parentName:"p"}),"\n","Future releases of ClickHouse Connect are guaranteed to be compatible with actively supported ClickHouse versions at the\ntime of release (generally the three most recent ",(0,r.kt)("inlineCode",{parentName:"p"},"stable")," and two most recent ",(0,r.kt)("inlineCode",{parentName:"p"},"lts")," releases)."),(0,r.kt)("h2",{id:"basic-usage"},"Basic Usage"),(0,r.kt)("h3",{id:"gather-your-connection-details"},"Gather your connection details"),(0,r.kt)(o.ZP,{mdxType:"ConnectionDetails"}),(0,r.kt)("h3",{id:"establish-a-connection"},"Establish a connection"),(0,r.kt)("p",null,"There are two examples shown for connecting to ClickHouse:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Connecting to ClickHouse server on localhost"),(0,r.kt)("li",{parentName:"ul"},"Connecting to a ClickHouse Cloud service")),(0,r.kt)("h4",{id:"use-a-clickhouse-connect-client-instance-to-connect-to-a-clickhouse-server-on-localhost"},"Use a ClickHouse Connect client instance to connect to a ClickHouse server on localhost:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"import clickhouse_connect\n\nclient = clickhouse_connect.get_client(host='localhost', username='default', password='password')\n")),(0,r.kt)("h4",{id:"use-a-clickhouse-connect-client-instance-to-connect-to-a-clickhouse-cloud-service"},"Use a ClickHouse Connect client instance to connect to a ClickHouse Cloud service:"),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Use the connection details gathered earlier.  ClickHouse Cloud services require TLS, so use port 8443."))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"import clickhouse_connect\n\nclient = clickhouse_connect.get_client(host='HOSTNAME.clickhouse.cloud', port=8443, username='default', password='your password')`\n")),(0,r.kt)("h3",{id:"interact-with-your-database"},"Interact with your database"),(0,r.kt)("p",null,"To run a ClickHouse SQL command, use the client ",(0,r.kt)("inlineCode",{parentName:"p"},"command")," method:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"client.command('CREATE TABLE new_table (key UInt32, value String, metric Float64) ENGINE MergeTree ORDER BY key')\n")),(0,r.kt)("p",null,"To insert batch data, use the client ",(0,r.kt)("inlineCode",{parentName:"p"},"insert")," method with a two-dimensional array of rows and values:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"row1 = [1000, 'String Value 1000', 5.233]\nrow2 = [2000, 'String Value 2000', -107.04]\ndata = [row1, row2]\nclient.insert('new_table', data, column_names=['key', 'value', 'metric']) \n")),(0,r.kt)("p",null,"To retrieve data using ClickHouse SQL, use the client ",(0,r.kt)("inlineCode",{parentName:"p"},"query")," method:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"result = client.query('SELECT max(key), avg(metric) FROM new_table')\nresult.result_set\nOut[13]: [(2000, -50.9035)]\n")))}k.isMDXComponent=!0},64872:function(t,e,n){e.Z=n.p+"assets/images/cloud-connect-button-e2247559831d9d3549387ddfb0deee9b.png"},33273:function(t,e,n){e.Z=n.p+"assets/images/connection-details-https-6ceceb667ac0b41ab35a2ad390b7e2dc.png"}}]);